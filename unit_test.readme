unit_test.c


The unit test code is setup to use psudo random numbers to exercise the basic functions of the library.
Reference output is provided for comparison to validate against. The reference output was generated using
the config.h in it's default state, i.e. TOTAL_BEACONS 11, MAX_AP_BEACONS 10. The code simulates server
Configuration overrides config.total_beacons = 8; config.max_ap_beacons = 6;

The unit_test executable is built into the bin directory. It will attempt to load state from the previous
run from the file nv_cache. Execute the unit test as follows:

# rm nv_cache (if necessary)
# bin/unit_test > unit_test_1.log
# bin/unit_test > unit_test_2.log
# bin/unit_test > unit_test_3.log
# bin/unit_test > unit_test_4.log
# bin/unit_test > unit_test_5.log

diff unit_test_?.log ref_log_cache_1
[ expect only timestamps to be different ]

Rebuild library and unit_test with CACHE_SIZE 5 (config.h) and compare with ref_log_cache_5

Rebuild unit_test with #define FAKE_NETWORK_TIME true and perform:

# rm nv_cache
# bin/unit_test > unit_test_fake.log

diff unit_test_fake.log ref_log_cache_5
